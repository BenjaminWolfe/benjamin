[{"authors":["admin"],"categories":null,"content":"Data scientist @DP_InsurTech , recreational #rstats developer, lifelong learner, analytics community builder, and tidyverse fan.\nI live in Austin, TX with my wife Karin and kids Brylie \u0026amp; Evan, all of us Bay Area transplants. When I\u0026rsquo;m not at my laptop, you can find me with my white lab, Ivy, my Roo hammock , my binoculars, and my journal.\n","date":1554595200,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":1583507311,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"Data scientist @DP_InsurTech , recreational #rstats developer, lifelong learner, analytics community builder, and tidyverse fan.\nI live in Austin, TX with my wife Karin and kids Brylie \u0026amp; Evan, all of us Bay Area transplants. When I\u0026rsquo;m not at my laptop, you can find me with my white lab, Ivy, my Roo hammock , my binoculars, and my journal.","tags":null,"title":"Benjamin E. Wolfe","type":"authors"},{"authors":null,"categories":null,"content":"Flexibility This feature can be used for publishing content such as:\n Online courses Project or software documentation Tutorials  The courses folder may be renamed. For example, we can rename it to docs for software/project documentation or tutorials for creating an online course.\nDelete tutorials To remove these pages, delete the courses folder and see below to delete the associated menu link.\nUpdate site menu After renaming or deleting the courses folder, you may wish to update any [[main]] menu links to it by editing your menu configuration at config/_default/menus.toml.\nFor example, if you delete this folder, you can remove the following from your menu configuration:\n[[main]] name = \u0026quot;Courses\u0026quot; url = \u0026quot;courses/\u0026quot; weight = 50  Or, if you are creating a software documentation site, you can rename the courses folder to docs and update the associated Courses menu configuration to:\n[[main]] name = \u0026quot;Docs\u0026quot; url = \u0026quot;docs/\u0026quot; weight = 50  Update the docs menu If you use the docs layout, note that the name of the menu in the front matter should be in the form [menu.X] where X is the folder name. Hence, if you rename the courses/example/ folder, you should also rename the menu definitions in the front matter of files within courses/example/ from [menu.example] to [menu.\u0026lt;NewFolderName\u0026gt;].\n","date":1536451200,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1579876495,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"/courses/example/","publishdate":"2018-09-09T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"Learn how to use Academic's docs layout for publishing online courses, software documentation, and tutorials.","tags":null,"title":"Overview","type":"docs"},{"authors":null,"categories":null,"content":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 2 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"74533bae41439377bd30f645c4677a27","permalink":"/courses/example/example1/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example1/","section":"courses","summary":"In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim.","tags":null,"title":"Example Page 1","type":"docs"},{"authors":null,"categories":null,"content":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\nTip 4 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"1c2b5a11257c768c90d5050637d77d6a","permalink":"/courses/example/example2/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/courses/example/example2/","section":"courses","summary":"Here are some more tips for getting started with Academic:\nTip 3 Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus.","tags":null,"title":"Example Page 2","type":"docs"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Academic\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes .  Further talk details can easily be added to this page using Markdown and $\\rm \\LaTeX$ math code.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"96344c08df50a1b693cc40432115cbe3","permalink":"/talk/example/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example/","section":"talk","summary":"An example talk using Academic's Markdown slides feature.","tags":[],"title":"Example Talk","type":"talk"},{"authors":[],"categories":[],"content":"   The Simplicity of Knitr’s HTML Output Example Setup  The Costs of Simplicity: File Size \u0026amp; Transparency File Size Transparency  Practical Consequences: Diffing Files Intermission! Adding the DT Library  Externalizing Code Using Content Delivery Networks (CDNs) Getting Started with CDNs Rounding Up Libraries Removing Them Pause: What We’ve Accomplished  Have a Script Do the Work Swapping in CDNs Removing Files Looping  Have Git Run the Script Writing a Bash Script Tweaking the R Script Troubleshooting Logging  Zip Your Files   The Simplicity of Knitr’s HTML Output Have you ever noticed that when you save a page from the internet, you get an HTML page plus an extra folder of supporting files?\nFor example, right-click on my website and click “Save As…,”\nand this is what you get:\nBut when you when you render an R Markdown file as HTML, instead it comes out as a single HTML file, with no folder of supporting files?\nIf you haven’t noticed this difference, or you don’t know what I mean, we’ll walk through a minimal reproducible example below to better understand it.\nThis simplicity makes your output very easy to share with stakeholders. But it has its drawbacks, and we’ll use the same example later in the post to see those as well. Then we’ll spend time exploring ways around those drawbacks.\nSince you might not be at your laptop to actually run this example, you can also find it in a separate GitHub repository. You can follow the repository commit by commit as we explore knitr’s simplicity, the down sides of that simplicity, and what can be done about those down sides. To cut to the chase, you can just look at my cdnify.R and pre-commit scripts there.\nThis upcoming section is covered by the third and fourth commits.\nExample Setup In RStudio, from the New File menu at the top left, choose R Markdown….\nIn the dialog box, feel free to add a title. Then select HTML and hit OK.\nSave the new file (I called it Report.Rmd) and then “knit” it, either using the knit button at top or by hitting Control+Shift_K (Command+Shift+K on a Mac).\nWhat you’ll get is a single file called something like report.html. Open it up to see a beautiful HTML version of the Rmd file you started with. This file is all you need to send to a stakeholder for them to open and read your work.\n  The Costs of Simplicity: File Size \u0026amp; Transparency Unfortunately, this simplicity comes with two costs.\nFile Size The first cost is file size. If you look at your report itself, you’ll see that it’s quite small: less than 1kB.\nBut the HTML file is more than 700kB.\nSo what changed? It’s obviously not that HTML is 700x longer than markdown for the same text.\nTwo things changed:\nThere’s now an embedded image (the plot). There are scripts and styling embedded in the file as well (JavaScript \u0026amp; CSS content).  We all know that images increase filesize. But it’s actually the scripts and styling that account for most of the difference:\n  original filesize if we take out the… the new size is… so it accounted for…    713 kB image 630 kB 83 kB  713 kB scripts + styling 93 kB 620 kB!     Transparency The second cost of putting everything in one easy-to-share HTML file is transparency.\nTo see this cost, let’s peel back the curtain a little on the HTML file. If you’re viewing the report in the RStudio viewer, go to the top left and click Open in Browser:\nThen with the report open in your browser of choice, right-click on the report and click View Page Source:\nAs you browse the page source, just under the title you’ll see what’s called minified code.\nLet’s talk through minified code for a moment.\nMinified JavaScript \u0026amp; CSS This small web page relies on a number of JavaScript and CSS libraries. One of them, the one depicted here, is a JS library called jQuery.\nUsually, when code—in any language—relies on a library, you simply refer to it at the top of the page with one line. For example, if you have an R script that relies on the lubridate package, you might include a line like this at the top of your script:\nlibrary(lubridate) Then throughout your script, R knows what to do when you use functions from the lubridate package.\nBut for that line to work, whoever’s running your code has to have lubridate installed on their computer. So in the case of our HTML report—which uses jQuery much like we might use lubridate—where would the library be installed?\nTo simplify all of that, and keep everything in one file, literally all of jQuery is included in report.html.\nBut libraries are big, of course; jQuery itself is 250kB. So we often use what’s called a minified version of the library. White space, new lines, and comments are stripped out, and variable names are as short as possible. It’s not meant to be readable; it’s meant to save filespace.\n Images Likewise, images are included within the text of the HTML document, encoded as text. To see this, scroll down in the source to where you’d expect to see the picture:\nThe picture is a png file, but it’s encoded as a long (83k characters!), otherwise meaningless string.\n   Practical Consequences: Diffing Files All of this has consequences for your workflow, perhaps the biggest of which is that you can’t diff files.\nIf you don’t use git much for version control, or you don’t follow the terminology, diffing files just means comparing files (or contrasting them) to look for differences. Diffing files is good for answering questions like “What changed since the last time I ran this?” or “What have I accomplished since my last commit?” It’s what you see when you pull up a git UI to see what’s changed.\nThe problem is that most interfaces won’t diff large files automatically, and some won’t diff them at all. This is what GitHub Desktop shows when I try to diff the HTML we just created:\nOf course you can click Show Diff. But even when you can diff the files, all the gobbledeegook—both minified code and text-encoded images—makes it harder to make sense of the changes.\n Intermission! In a moment we’ll walk through 3 tips to tidy up your HTML output and reduce your file size while keeping things easy to share.\nBut before we do that I’d like to make just one change to our report. (If you’re following along in GitHub, see this commit.) You can skip this section if you like. All we’re doing is making the dataset summary section a little prettier.\nAdding the DT Library Here’s what the dataset summary looks like right now:\nIt’s functional and informative in the aggregate, though a little plain. But let’s say our client wants to be able to browse the actual data, and let’s say they like things to look a little prettier.\nFor that we use the DT library, which takes just 3 lines of code. First make sure you’ve installed it:\ninstall.packages(\u0026quot;DT\u0026quot;) Then add a library call to the setup code chunk in your report:\n```{r setup, include=FALSE} knitr::opts_chunk$set(echo = TRUE) library(DT) # add this line ``` And finally change the cars code chunk from this—\n```{r cars} summary(cars) ``` —to this:\n```{r cars} datatable(cars) ``` And now the HTML is super pretty!\nI include this example to show that with every change to pretty up your report, add widgets or improve the styling, you’re going to continue adding minified JS or CSS and increasing the filesize. In this case, we’re now up to 916 kilobytes, another increase of 203 kB!\nAnd now with that taken care of, we turn to the solution. As mentioned above we’ll walk through 3 steps:\n  step (see below) solves…    code externalization transparency  content delivery networks (CDNs) file size  file compression (.zip) ease of use      Externalizing Code As we’ve seen, your HTML file includes entire libraries of JS \u0026amp; CSS code in it: code that bloats the file, code that won’t appreciably change from one version to the next, code that you couldn’t read even if you wanted to, because it’s minified.\nSo the first thing to do is to split that code out into its own JavaScript and CSS files. What’s left in the HTML file will then be actual content. It will be small enough to diff and meaningful to diff. And if the libraries change, you can track that separately.\nLet’s get to it.\nAt the end of the YAML at the top of your file is a line that tells knitr how to output results:\noutput: html_document We need to change that so that knitr no longer tries to keep everything in the same document:\noutput: html_document: self_contained: false When we do, and re-knit, the change is striking. Suddenly the HTML file is only 7 kB (down 99%!):\nIt’s smaller because all the code has been moved to a separate folder, a folder called report_files. This folder is normal; it’s what you get when you save a page off the internet, as we saw above.\nNot only is the HTML file smaller, but the git diff is now a lot more readable. In the diff from this commit in GitHub, for example, each library file shows up separately, and you can identify each one by filename without looking at the contents:\nAnd the HTML file itself is much more readable. I encourage you to check it out, either by viewing the source on own HTML file or checking my repo.\nThere is one significant downside, though. While the files are cleaner, smaller, and easier to diff, we’ve increased the overall filesize more than 4x. The new report_files folder takes up 4.3 megs!\nWhere does this size come from?\nIn our case, 3.7 of those megabytes come from the Bootstrap library, which bills itself as “the most popular HTML, CSS, and JS library in the world.” Basically, it makes our content look pretty.\nNow, filesize may not be an issue for you. If you host your files on a web server or shared file system, you might just send links. Sending links is usually the best way to share content anyway.\nBut if you have to send attachments, or if you send links but your shared space has storage restrictions, you’ll want to pare down.\n Using Content Delivery Networks (CDNs) Putting aside the filesize issue for just a moment, at this point you might have a question:\n If Boostrap is the most popular HTML, CSS, and JS library in the world—obviously use by a lot of people—all these people can’t be hosting Bootstrap separately, can they? There’s got to be a way to point to a common location.\n If you have that question (as I did), you would be right! And the way it’s done is called a Content Delivery Network, or CDN.\nYou can see it, for example, on Bootstrap’s site:\nBootstrap is providing URLs for common locations where they host the library for everyone. Developers can then point to these URLs at the top of their HTML code, much like you’d include library(lubridate) at the top of an R script.\nGetting Started with CDNs Currently, your file does something similar, not quite the same; it doesn’t use CDNs. It does point to Bootstrap and other libraries at the top—\n—but the library references are local, pointing to files in the report_files folder. What we want, then, is to replace those references with CDNs.\nThen we can delete the local versions we no longer need, and—back to the problem we were solving—we’ll have reduced the overall filesize.\nSo again:\nFirst we find all the libraries we’re referencing, and see which ones have CDNs we can use. Then we swap the local references to CDNs and remove the files that are no longer necessary. Lastly we’ll automate the whole thing, so that every time we check in changes to our repository after knitting a report to HTML, all of this happens automatically.   Rounding Up Libraries This step might be different for your scenario. Maybe you’re using HTML widgets, or maybe you’re not using Bootstrap. I go through the process first because some of the code may be exactly the same, and second so you can follow it for your own report.\nSo what are all the libraries we’re using? As you saw in the most recent screenshot, this is what we’re looking at:\n\u0026lt;script src=\u0026quot;report_files/jquery-1.12.4/jquery.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/bootstrap-3.3.5/css/bootstrap.min.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/bootstrap-3.3.5/js/bootstrap.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;report_files/bootstrap-3.3.5/shim/html5shiv.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;report_files/bootstrap-3.3.5/shim/respond.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;report_files/navigation-1.1/tabsets.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/highlightjs-9.12.0/default.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/highlightjs-9.12.0/highlight.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;report_files/htmlwidgets-1.5.1/htmlwidgets.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/datatables-css-0.0.0/datatables-crosstalk.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/datatables-binding-0.11/datatables.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/dt-core-1.10.19/css/jquery.dataTables.min.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;link href=\u0026quot;report_files/dt-core-1.10.19/css/jquery.dataTables.extra.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/dt-core-1.10.19/js/jquery.dataTables.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/crosstalk-1.0.0/css/crosstalk.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/crosstalk-1.0.0/js/crosstalk.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; Let’s notice a few things about what we’re looking at:\n Each of these is either a link (for a CSS file) or a script (for JavaScript). The part we want to change is in quotes after href= or src=. Each time it starts with report_files/, since that’s where all the local libraries are stored. Each of them has semantic versioning (or semver): generally x.y.z, where x is the major version, y the minor version, and z the current patch.  With that in mind, let’s write it a little more cleanly:\n   Filepath w/in report_files  Version      jquery-x.y.z/jquery.min.js  1.12.4    bootstrap-x.y.z/css/bootstrap.min.css  3.3.5    bootstrap-x.y.z/js/bootstrap.min.js  3.3.5    bootstrap-x.y.z/shim/html5shiv.min.js  3.3.5    bootstrap-x.y.z/shim/respond.min.js  3.3.5    navigation-x.y/tabsets.js  1.1    highlightjs-x.y.z/default.css  9.12.0    highlightjs-x.y.z/highlight.js  9.12.0    htmlwidgets-x.y.z/htmlwidgets.js  1.5.1    datatables-css-x.y.z/datatables-crosstalk.css  0.0.0    datatables-binding-x.y/datatables.js  0.11    dt-core-x.y.z/css/jquery.dataTables.min.css  1.10.19    dt-core-x.y.z/css/jquery.dataTables.extra.css  1.10.19    dt-core-x.y.z/js/jquery.dataTables.min.js  1.10.19    crosstalk-x.y.z/css/crosstalk.css  1.0.0    crosstalk-x.y.z/js/crosstalk.min.js  1.0.0     I was able to find CDNs for the 9 green rows, simply by googling [name of library] [version] CDN for each one.\nHere, in order, are the ones I found. While I tried to match the versioning, if it was close sometimes I took what I could get.\n   CDN  Version Googled  Version Found      https://code.jquery.com/jquery-1.12.4.min.js  1.12.4  1.12.4    https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css  3.3.5  3.3.5    https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js  3.3.5  3.3.5    https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js  3.3.5  3.7.3    https://oss.maxcdn.com/respond/1.4.2/respond.min.js  3.3.5  1.4.2    https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/default.min.css  9.12.0  9.18.0    https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js  9.12.0  9.18.0    https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css  1.10.19  1.10.20    https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js  1.10.19  1.10.20      Removing Them To be clear, the next step is very straightforward. We simply have to replace the strings that look like this—\nreport_files/bootstrap-3.3.5/css/bootstrap.min.css —with ones that look like this:\nhttps://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css Then, since the file report_files/bootstrap-3.3.5/css/bootstrap.min.css is no longer needed, we can delete it from report_files.\nWe’re going to do these steps manually first, and then try scripting them.\nManual Example So first open report.html in your favorite text editor:\nThen delete the href:\nThis is a great opportunity to take a look behind the scenes. Remember what the report looked like before you deleted that href:\nIf you save the report right now, with the href deleted out, and open it in Chrome, it looks like this instead:\nSeeing this helps you understand what Bootstrap was doing for our report, and it also helps verify when we fix it. Now copy-paste in the URL of the CDN—\n—and save and open in Chrome again. Everything’s back to normal! The CDN worked.\nSince the CDN worked, we no longer need the file report_files/bootstrap-3.3.5/css/bootstrap.min.css and we can delete it.\nYou can even refresh the page in Chrome now, and you’ll see it still works without the local file.\nSo now, since that worked, it’s time to take care of the rest of the references! In cooking-show style, I’ll simply pull the completed pie from the oven and show you what it looks like.\nThis is the section right under the title in the HTML file. You can copy-paste them into your file if you’re following along at home.\n\u0026lt;script src=\u0026quot;https://code.jquery.com/jquery-1.12.4.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;meta name=\u0026quot;viewport\u0026quot; content=\u0026quot;width=device-width, initial-scale=1\u0026quot; /\u0026gt; \u0026lt;link href=\u0026quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;https://oss.maxcdn.com/respond/1.4.2/respond.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;report_files/navigation-1.1/tabsets.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/default.min.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;script src=\u0026quot;report_files/htmlwidgets-1.5.1/htmlwidgets.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/datatables-css-0.0.0/datatables-crosstalk.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/datatables-binding-0.11/datatables.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;link href=\u0026quot;report_files/dt-core-1.10.19/css/jquery.dataTables.extra.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt; \u0026lt;link href=\u0026quot;report_files/crosstalk-1.0.0/css/crosstalk.css\u0026quot; rel=\u0026quot;stylesheet\u0026quot; /\u0026gt; \u0026lt;script src=\u0026quot;report_files/crosstalk-1.0.0/js/crosstalk.min.js\u0026quot;\u0026gt;\u0026lt;/script\u0026gt;  Deleting Files Now, in the previous section after we deleted bootstrap.min.css, we only deleted that one file, but we left the rest standing. But we don’t have to be that careful.\nYou’ll notice there are just 7 local references left in report_files:\n navigation-1.1/tabsets.js htmlwidgets-1.5.1/htmlwidgets.js datatables-css-0.0.0/datatables-crosstalk.css datatables-binding-0.11/datatables.js dt-core-1.10.19/css/jquery.dataTables.extra.css crosstalk-1.0.0/css/crosstalk.css crosstalk-1.0.0/js/crosstalk.min.js  Why not just keep those files and delete the rest? You can do this manually any way you want to, but it’s easiest for me to consolidate the important files to a temp directory,\ndelete the rest,\nand then move the important files back.\nPlease notice along with the important files I also kept the folder figure-html, since that’s where our plot lives! Whatever script we write will have to find that as well.\n  Pause: What We’ve Accomplished I want to take a moment to celebrate our successes. First, if you open your HTML file in Chrome, you’ll find that everything works. We’ve replaced the local references with CDNs, and we truly no longer needed the local files!\nSecond, the report_files folder is now only 435 kB: 90% smaller than the original folder, and less than half the size of the original file before we split out the libraries.\nIf you don’t care to script or automate the process, feel free to skip down to Zip Your Files and call it good!\n  Have a Script Do the Work Now comes the time when we ask ourselves:\n This seems pretty straightforward. Do you think we can do it in a script?\n And the answer is, of course we can! This is R. There’s got to be a way to do it.\nTo slow things down, I’m going to write it piece by piece. If you’re impatient and want to skip to the end, go for it!\nSwapping in CDNs First we’ll do some setup work that should be fairly self-explanatory.\nlibrary(tidyverse) library(here) # make a tibble of references to be replaced references \u0026lt;- tibble( local_file = c( \u0026quot;jquery-1.12.4/jquery.min.js\u0026quot;, \u0026quot;bootstrap-3.3.5/css/bootstrap.min.css\u0026quot;, \u0026quot;bootstrap-3.3.5/js/bootstrap.min.js\u0026quot;, \u0026quot;bootstrap-3.3.5/shim/html5shiv.min.js\u0026quot;, \u0026quot;bootstrap-3.3.5/shim/respond.min.js\u0026quot;, \u0026quot;highlightjs-9.12.0/default.css\u0026quot;, \u0026quot;highlightjs-9.12.0/highlight.js\u0026quot;, \u0026quot;dt-core-1.10.19/css/jquery.dataTables.min.css\u0026quot;, \u0026quot;dt-core-1.10.19/js/jquery.dataTables.min.js\u0026quot; ), cdn_url = c( \u0026quot;https://code.jquery.com/jquery-1.12.4.min.js\u0026quot;, \u0026quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\u0026quot;, \u0026quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\u0026quot;, \u0026quot;https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js\u0026quot;, \u0026quot;https://oss.maxcdn.com/respond/1.4.2/respond.min.js\u0026quot;, \u0026quot;https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/default.min.css\u0026quot;, \u0026quot;https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js\u0026quot;, \u0026quot;https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css\u0026quot;, \u0026quot;https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js\u0026quot; ) ) # set the filepath information html_file \u0026lt;- here(\u0026quot;report\u0026quot;) # filepath without the extension fullpath \u0026lt;- paste0(html_file, \u0026quot;.html\u0026quot;) # actual name of HTML file dir_path \u0026lt;- paste0(html_file, \u0026quot;_files\u0026quot;) # directory of local libraries # also just the name of the directory will come in handy dependency_dir \u0026lt;- \u0026quot;report_files\u0026quot; # grab the page contents page_contents \u0026lt;- read_lines(fullpath) Note: If you’re not familiar with the here package, I highly recommend Jenny Bryan’s ode, “I love the here package. Here’s why.” In this case html_file should be wherever report.html lives (e.g. /Users/benjamin/Documents/report.html), but without the .html file extension.\nNow let’s make the replacements.\n# the actual strings we\u0026#39;re replacing always start with report_files/ references \u0026lt;- mutate( references, local_file = paste(dependency_dir, local_file, sep = \u0026quot;/\u0026quot;) ) page_contents \u0026lt;- reduce2( .x = references$local_file, .y = references$cdn_url, .f = str_replace, .init = page_contents ) write_lines(page_contents, fullpath) Here purrr::reduce2 is the work horse. It runs through our replacements iteratively, as if we’d written it like this:\npage_contents \u0026lt;- page_contents %\u0026gt;% str_replace(references$local_file[1], references$cdn_url[1]) %\u0026gt;% str_replace(references$local_file[2], references$cdn_url[2]) %\u0026gt;% str_replace(references$local_file[3], references$cdn_url[3]) %\u0026gt;% str_replace(references$local_file[4], references$cdn_url[4]) %\u0026gt;%  …and so on down the line.\nAnd we use write_lines from the readr package (loaded with the tidyverse) to write the contents back to the HTML file.\n Removing Files Now that we’ve swapped local references for CDNs, we can go about deleting files. First we’ll want to decide what we need to keep, and this function will do that for us:\nget_remaining \u0026lt;- function(page_contents) { pattern \u0026lt;- paste0(dependency_dir, \u0026quot;/([^\\\u0026quot;]+)\u0026quot;) # pattern to watch for remaining_lines \u0026lt;- str_which(page_contents, pattern) # what lines have it? if (!length(remaining_lines)) return(NA_character_) # none? return NA. str_match(page_contents[remaining_lines], pattern)[, 2] # return matches } Here remember what you’re looking for is report_files, followed by a slash /, followed by a partial filepath. This function defines that partial filepath by the regular expression [^\\\u0026quot;]+, which is one way to say “any character but a quotation mark, one or more times.” For more on regular expressions and how I used them here, see the stringr documentation, especially the page on str_match.\nTo actually delete the files, I turn to the fs package. It has intuitively named, vectorized functions like\n path to construct a filepath, dir_ls to list the files in a directory, and file_delete to delete files.  library(fs) # keep the files still explicitly named in the HTML keep_these \u0026lt;- path(dir_path, get_remaining(page_contents)) # remove everything else in the report_files folder remove_these \u0026lt;- setdiff( dir_ls(dir_path, recurse = TRUE, type = \u0026quot;file\u0026quot;), keep_these ) file_delete(remove_these)  Looping Now let’s say you might have more than one HTML files—not just report.html. You could wrap everything we just did in a function, and run that function for all the relevant files in a particular directory.\nLet’s call the function cdnify:\nlibrary(tidyverse) library(here) library(fs) # make a tibble of references to be replaced references \u0026lt;- tibble( local_file = c( \u0026quot;jquery-1.12.4/jquery.min.js\u0026quot;, \u0026quot;bootstrap-3.3.5/css/bootstrap.min.css\u0026quot;, \u0026quot;bootstrap-3.3.5/js/bootstrap.min.js\u0026quot;, \u0026quot;bootstrap-3.3.5/shim/html5shiv.min.js\u0026quot;, \u0026quot;bootstrap-3.3.5/shim/respond.min.js\u0026quot;, \u0026quot;highlightjs-9.12.0/default.css\u0026quot;, \u0026quot;highlightjs-9.12.0/highlight.js\u0026quot;, \u0026quot;dt-core-1.10.19/css/jquery.dataTables.min.css\u0026quot;, \u0026quot;dt-core-1.10.19/js/jquery.dataTables.min.js\u0026quot; ), cdn_url = c( \u0026quot;https://code.jquery.com/jquery-1.12.4.min.js\u0026quot;, \u0026quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\u0026quot;, \u0026quot;https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\u0026quot;, \u0026quot;https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js\u0026quot;, \u0026quot;https://oss.maxcdn.com/respond/1.4.2/respond.min.js\u0026quot;, \u0026quot;https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/styles/default.min.css\u0026quot;, \u0026quot;https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@9.18.0/build/highlight.min.js\u0026quot;, \u0026quot;https://cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css\u0026quot;, \u0026quot;https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js\u0026quot; ) ) cdnify \u0026lt;- function(html_file) { # set the filepath information fullpath \u0026lt;- paste0(html_file, \u0026quot;.html\u0026quot;) # actual name of HTML file dir_path \u0026lt;- paste0(html_file, \u0026quot;_files\u0026quot;) # directory of local libraries # also just the name of the directory will come in handy dependency_dir \u0026lt;- path_file(dir_path) # grab the page contents page_contents \u0026lt;- read_lines(fullpath) # the actual strings we\u0026#39;re replacing always start with report_files/ references \u0026lt;- mutate( references, local_file = paste(dependency_dir, local_file, sep = \u0026quot;/\u0026quot;) ) page_contents \u0026lt;- reduce2( .x = references$local_file, .y = references$cdn_url, .f = str_replace, .init = page_contents ) write_lines(page_contents, fullpath) get_remaining \u0026lt;- function(page_contents) { pattern \u0026lt;- paste0(dependency_dir, \u0026quot;/([^\\\u0026quot;]+)\u0026quot;) # pattern to watch for remaining_lines \u0026lt;- str_which(page_contents, pattern) # what lines have it? if (!length(remaining_lines)) return(NA_character_) # none? return NA. str_match(page_contents[remaining_lines], pattern)[, 2] # return matches } # keep the files still explicitly named in the HTML keep_these \u0026lt;- path(dir_path, get_remaining(page_contents)) # remove everything else in the report_files folder remove_these \u0026lt;- setdiff( dir_ls(dir_path, recurse = TRUE, type = \u0026quot;file\u0026quot;), keep_these ) file_delete(remove_these) } Now purrr::walk will do the heavy lifting, applying cdnify to the relevant files.\ncurrent_dir \u0026lt;- here() # or whatever directory # list all the HTML files anywhere in current_dir (but w/o the html extension) pages \u0026lt;- current_dir %\u0026gt;% dir_ls(recurse = T, regexp = \u0026quot;\\\\.html\u0026quot;) %\u0026gt;% str_replace(\u0026quot;\\\\.html$\u0026quot;, \u0026quot;\u0026quot;) # HTML files are only relevant if they come from an R Markdown file, # and if they have a folder of local dependencies are_from_markdown \u0026lt;- file_exists(paste0(pages, \u0026quot;.Rmd\u0026quot;)) have_dependencies \u0026lt;- dir_exists(paste0(pages, \u0026quot;_files\u0026quot;)) walk( pages[are_from_markdown \u0026amp; have_dependencies], cdnify )   Have Git Run the Script Now that we’ve scripted the whole process, I’d prefer not to have to think about it at all.\nWe can accomplish that goal by creating what’s called a git hook. Git hooks are bash scripts that run when you do things in git; you can write hooks that run automatically before a commit, before you rebase, or before you push changes, for example. In this case, we can tell the bash script where to find our R script, and where to find the R interpreter. Then once we’ve set it in motion, we never have to think about our script again!\n(Aside: It’s possible you’re not using git at all. Many R users, data scientists, and coders in general highly recommend it! If you’re starting from the ground up, you can take advantage of some great resources, like Jenny Bryan and Jim Hester’s Happy Git and GitHub for the useR. If you feel reasonably comfortable with git, read on!)\nTo make our git hook, you first need to make sure you’re seeing hidden files. On a Mac you can do that by pressing Command-Shift-Period in Finder. Then in the folder you’re in, go to .git → hooks → pre-commit.sample. Make a copy of pre-commit.sample, and delete the .sample part.\nHere you see concretely all the git events that you can “hook” with a git hook. pre-commit is only one option. But it’s important we run the script to remove local files “pre-commit,” because otherwise those libraries will live on in your commit history, bloating the repository forever.\nWriting a Bash Script Now I don’t actually know bash well, but that’s what Google is for:\n#!/bin/sh # check these variables (using forward slashes instead of backslashes): R_SCRIPT=\u0026quot;/usr/local/bin/Rscript\u0026quot; # the location of Rscript on your computer CDN_SCRIPT=\u0026quot;cdnify.R\u0026quot; # the location of the R script in the repo # find the local REPO directory HOOKS_DIR=\u0026quot;$( cd \u0026quot;$( dirname \u0026quot;${BASH_SOURCE[0]}\u0026quot; )\u0026quot; \u0026amp;\u0026amp; pwd )\u0026quot; GIT_DIR=\u0026quot;$(dirname \u0026quot;$HOOKS_DIR\u0026quot;)\u0026quot; REPO=\u0026quot;$(dirname \u0026quot;$GIT_DIR\u0026quot;)\u0026quot; # switch to CDNs \u0026quot;$R_SCRIPT\u0026quot; \u0026quot;$REPO/$CDN_SCRIPT\u0026quot; \u0026quot;$REPO\u0026quot; # stage updated files git add -u exit 0 Let’s walk through a few parts of that script:\n HOOKS_DIR is the location of your_repository/.git/hooks, where the pre-commit script lives. GIT_DIR is the location of your_repository/.git. REPO is the location of your repository.  So this line—\n\u0026quot;$R_SCRIPT\u0026quot; \u0026quot;$REPO/$CDN_SCRIPT\u0026quot; \u0026quot;$REPO\u0026quot; —translates to something like this:\n\u0026quot;/usr/local/bin/Rscript\u0026quot; \u0026quot;/Users/benjamin/Documents/GitHub/knitr-cdn-demo/cdnify.R\u0026quot; \u0026quot;/Users/benjamin/Documents/GitHub/knitr-cdn-demo\u0026quot; It’s saying to run the R interpreter on your cdnify.R script, and pass the path of the repo to that script. I’ll add that for many people, /usr/local/bin is on something called your PATH, and you can get away with skipping it:\nR_SCRIPT=\u0026quot;Rscript\u0026quot; Now, unfortunately this script will do exactly what we tell it to do, not what we want it to do. So if we leave it there, it will make the appropriate changes and follow through with your commit… without staging the new changes!\nThis is why we add git add -u at the end, to ensure the changes stick. But beware that this line also has an important side effect: Any changes to your repo will be staged and committed, even if you hadn’t staged them yourself.\nThere could be a way to do this differently—maybe have R return a list of files to stage, to be more surgical about it—but that lies beyond my current bash scripting abilities.\n Tweaking the R Script We just said that this line—\n\u0026quot;/usr/local/bin/Rscript\u0026quot; \u0026quot;/Users/benjamin/Documents/GitHub/knitr-cdn-demo/cdnify.R\u0026quot; \u0026quot;/Users/benjamin/Documents/GitHub/knitr-cdn-demo\u0026quot; —passes the location of the repository to the R script. We also need to tell the script what to do with it.\nTo pull command-line arguments into an R script, we use the commandArgs function. commandArgs() returns a vector of the arguments you passed to the script. commandArgs()[1] will return just the first argument; as.character(commandArgs()[1]) ensures it’s passed in as a character string.\nSo we could replace this line near the bottom of our script—\ncurrent_dir \u0026lt;- here() —with this one—\ncurrent_dir \u0026lt;- as.character(commandArgs(trailingOnly = T)[1]) —and our script would always automatically run on the git repository.\nBut sometimes we’ll still want to run the script on its own, right? To have the code automatically differentiate between contexts (git or manual), we can use the interactive function:\ncurrent_dir \u0026lt;- if (interactive()) { here() } else { as.character(commandArgs(trailingOnly = T)[1]) }  Troubleshooting Before git is able to run the githook, sometimes your OS needs to know that it’s executable. If that happens you might get something like the yellow error message here:\nThe answer is to run this simple line from the command line:\nchmod +x .git/hooks/pre-commit chmod is an abbreviation of “change mode,” and the +x means “make it executable.” It’s not rocket science, just (again) good Googling.\nThen your file should be clearly different from the sample githook files (though the exact way that’s shown will vary from OS to OS):\n Logging Lastly, we want to make sure that troubleshooting is easier in the future. One way to do that is to add logging, or at least messaging. For the full version of the script with thorough logging, please see cdnify.R on GitHub.\nThis is what your terminal output looks like when you run it, even when you haven’t re-knit any HTML files, so there’s nothing to remove:\nHere’s a quick preview of the changes you’ll see in the enhanced script:\n I don’t load the whole tidyverse, only the specific packages I use. I start with a whole elaborate function to provide messaging around packages. Much of this is about troubleshooting, so I’m sure to message which if any packages failed as well. If a package fails to load I actually attempt to install it from CRAN, and then try to load it again. I spend time capturing which version of each library was found in the file, again for troubleshooting. If knitr suddenly upgrades its default versions of Bootstrap or jQuery, I just want to be able to notice that. The code is also more flexible, so that the newer version would get picked up. Timestamps and actions are explicitly spelled out. If anything is changed, you’ll see exactly what, including which version was removed and what URL was used to replace it.    Zip Your Files In the end, this method does leave you with a folder of files to share, rather than a simple HTML file. You can still send them easily by zipping both the report and the report files into a single zip folder.\nIn this case, the final zipped size was a meager 80 kilobytes: less than a tenth the size of the original uncompressed HTML file.\nYou may still work in a context where your stakeholders either can’t or won’t open a zip file and click through on the single HTML file inside it. Unfortunately, I don’t have a solution for that problem.\nBut what we have solved can still be quite useful: Your report now takes a tenth of the size it once did, and perhaps more importantly you’re able to diff your output files and easily understand what’s changed.\n ","date":1583452800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1583850421,"objectID":"a72381d20a9cdad36074bcb03b3da4c5","permalink":"/post/2020-03-06-r-markdown-shrink-clarify-your-html-output-with-cdns/","publishdate":"2020-03-06T00:00:00Z","relpermalink":"/post/2020-03-06-r-markdown-shrink-clarify-your-html-output-with-cdns/","section":"post","summary":"The Simplicity of Knitr’s HTML Output Example Setup  The Costs of Simplicity: File Size \u0026amp; Transparency File Size Transparency  Practical Consequences: Diffing Files Intermission! Adding the DT Library  Externalizing Code Using Content Delivery Networks (CDNs) Getting Started with CDNs Rounding Up Libraries Removing Them Pause: What We’ve Accomplished  Have a Script Do the Work Swapping in CDNs Removing Files Looping  Have Git Run the Script Writing a Bash Script Tweaking the R Script Troubleshooting Logging  Zip Your Files   The Simplicity of Knitr’s HTML Output Have you ever noticed that when you save a page from the internet, you get an HTML page plus an extra folder of supporting files?","tags":["R Markdown","HTML","Reproducibility"],"title":"R Markdown: Shrink \u0026 Tidy Up Your HTML Output with CDNs","type":"post"},{"authors":["Benjamin E. Wolfe"],"categories":null,"content":" Click the Slides button above to demo Academic\u0026rsquo;s Markdown slides feature.   Supplementary notes can be added here, including code and math .\n","date":1554595200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"557dc08fd4b672a0c08e0a8cf0c9ff7d","permalink":"/publication/preprint/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/preprint/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example preprint / working paper","type":"publication"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Academic  Academic | Documentation  Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click  PDF Export : E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions?  Ask  Documentation ","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Academic's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"},{"authors":["Benjamin E. Wolfe","Robert Ford"],"categories":null,"content":" Click the Cite button above to demo the feature to enable visitors to import publication metadata into their reference management software.    Click the Slides button above to demo Academic\u0026rsquo;s Markdown slides feature.   Supplementary notes can be added here, including code and math .\n","date":1441065600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"966884cc0d8ac9e31fab966c4534e973","permalink":"/publication/journal-article/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/journal-article/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example journal article","type":"publication"},{"authors":["Benjamin E. Wolfe","Robert Ford"],"categories":null,"content":" Click the Cite button above to demo the feature to enable visitors to import publication metadata into their reference management software.    Click the Slides button above to demo Academic\u0026rsquo;s Markdown slides feature.   Supplementary notes can be added here, including code and math .\n","date":1372636800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579876495,"objectID":"69425fb10d4db090cfbd46854715582c","permalink":"/publication/conference-paper/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/publication/conference-paper/","section":"publication","summary":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum.","tags":["Source Themes"],"title":"An example conference paper","type":"publication"}]